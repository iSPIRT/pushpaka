Categorisation

Name
Description
C0
Fallback
C1…Cn
Other categories that may rely on messaging protocols other than in as described here.

System Requirements
Let Pi be a C0 process performing deconfliction under a USS.

P MUST
Be supported by all DSP/USSs
Agree
All correct processes must agree on the same value.
Be deterministic
Be unilaterally calculable
Terminate
All processes must 
eventually decide on an output value
Be efficiently calculable
Be a finite calculation
Allow preemption of operations with lower priority by those with higher priority
Provide explicit acknowledgement to other negotiation process(es) Pi of the planned intersection volumes when intersection is mutually decided
Provide details to other negotiation process(es) Pi on approach to a separation provision while in intersecting operation volumes when intersection is mutually decided
P SHOULD
Minimise human interaction
Apply associativity in calculating conflicts

Negotiation
Messages to be exchanged between DSP/USS category C0 processes Pi entering into a negotiation.

```
/**
  * A party notifies other parties of conflict.
  */
conflict_notification {
  UUID        id
  UUID        dsp_id
  UUID        dsp_instance_id
  UUID        party_id
  FlightPlan  flight_plan
  DateTime    conflict_start
  DateTime    conflict_end
}
```

```
/**
  * A party notifies other parties of a flight plan proposal for conflict resolution.
  */
deconfliction_proposal {
  UUID        id
  UUID        dsp_id
  UUID        dsp_instance_id
  UUID        party_id
  FlightPlan  proposed_flight_plan
  DateTime    timestamp
  string      free_text
}
```

```
/**
  * A party notifies other parties of receipt of deconfliction_proposal.
  */
deconfliction_proposal_acknowledgement {
  UUID        id
  UUID        dsp_id
  UUID        dsp_instance_id
  UUID        party_id
  UUID        proposal_id
  DateTime    timestamp
}
```

```
/**
  * A party notifies other parties that proposal is not in conflict with one's own 
  * flight plan.
  */
no_conflict_notification {
  UUID        id
  UUID        dsp_id
  UUID        dsp_instance_id
  UUID        party_id
  UUID        proposal_id 
  DateTime    timestamp
}
```

```
/**
  * A party notifies other parties that a proposal that is not in conflict with one's 
  * own flight plan has been agreed on as a conflict resolution.
  */
deconfliction_accepted {
  UUID        id
  UUID        dsp_id
  UUID        dsp_instance_id
  UUID        party_id
  UUID        proposal_id 
  DateTime    timestamp
}
```

Sayandeep
Actor: Operator
Action: Define operation volume (incl. Contingency volume), send to DSP, recv 
Estimated traffic density during operation
Estimated max cruise altitude
Launch, recovery locations

On Negotiation during Deconfliction
TBD
Nihal
Priority - High
Complexity - High
Scope -  both BVLOS and VLOS. Primary role in BVLOS. 
Actors - At least two DSPs and Operators, Conflict Advisory Service, InterDSP Communication
One line Definition - process for avoiding mutual interference or outright hazards among entities or elements in the same domain[2]

Digital sky dependency -  Pre-flight advisory and in flight data exchange between DSP’s

Responsibilities of the Service -  resolve potential conflicts in flight operations. 

This can be done in two phases - Pre flight advisory and in-flight resolution. This follows the industry model of dealing with conflict resolution scenarios[1]. Restricting to the base use case of UAS-UAS conflicts, provides a simplified framework to think of possible use-cases and scenarios.  

Pre-flight advisory can be apart of the below service which includes all potential risks that the operator can face that needs to be informed to the operator. One aspect of this is potential overlap in flight with another UAS. Digital sky is in an advantageous position over other providers as flights have to be requested in advance. This information can help one planning flight/seeking permission to be notified of any overlaps that occur. Mechanism of implementation can go from notification to warning before second agent submits their flight permission application. 

Pre-flight advisory will result in two possible outcomes -  
Where the operator understands the risks and proceeds to fly
Where the Operator can decide to Reschedule his flight

Strategic deconfliction service applies only in scenario 1. This is the second phase of application -  in flight conflict resolution. 

In flight conflict Resolution requires access to data to resolve conflicts. This data includes - 
Real time and Planned flight data of both participating UAS in potential conflict 
Communication channel to other DSP (interDSP communication service)
The stages and possible solutions for resolution can be found in the Universal Deconfliction model for UTM[2]

Open thoughts and questions:
The resolution generated by different DPS needs a  hierarchy/priority resolution solution. Example -  Conflict resolution between multiple UAS can be done by avoiding/changing flight path by either UAS. Who should ultimately take action? One? Both? How is this resolved between different DSPs? If both UAS are within same UAS. it becomes easy. 

All services need to be looked at from the perspective that Digital sky unlike FIMS is a more aware entity as any possible flight needs to be registered with it before it can happen. The frameworks from EU and US rely on incomplete information. 

Incomplete information and passive obstacle avoidance needs to be features of the RPAS. As all flights may not be online and connected to the centralized DSP server/ UFII, offline obstacle avoidance is required for the RPAS. This can appear in the form of pilot in command (PIC) in the case of VLOS flights, or DAS (Detect and Avoid Systems) in the case of BVLOS systems. 

References - 
[1] Altitude Angel Tactical and Strategic CRS - https://www.geospatialworld.net/news/altitude-angel-launches-second-phase-of-its-game-changing-conflict-resolution-service-tactical-deconfliction/
[2] Universal Deconliction Model for UTM - https://www.linkedin.com/pulse/universal-deconfliction-model-utm-paul-pocialik/
[3]ERASMUS - deconfliction report
http://www.atmseminarus.org/seminarContent/seminar8/papers/p_146_IAC.pdf
[4]NASA -  Deconfliction Report
https://utm.arc.nasa.gov/docs/2018-UTM-Strategic-Deconfliction-Final-Report.pdf

Merged
Regulated: Yes (Level 0) and No (Level 1: DSP-innovated Value added services)
Priority: High
Critical: Yes (level 0) and No (Level 1)
Related: Planning
Stage: permission taking & during ops
APIs required: UAO/S-DSP, DSP-DSP, DSP-UFII

Inflight deconfliction now moved to Dynamic Rerouting Service.


9.1 API: UAO/S-DSP
Input: 
Purpose of mission
Operational Volume
(mandatory) Geofence
(mandatory) Time range
(optionally) waypoints + contingency radius
(optionally) volume
Output:
Expected UAS traffic density profile vs time
Suggested deconflicted UAS operational volume(s)
Launch/recovery geolocations

9.2 API: DSP-DSP
Notes: Required if UFII does not track all pending permission requests. 
Input: 
Purpose of mission
Operational Volume
(mandatory) Geofence
(mandatory) Time range
(optionally) waypoints + contingency radius
(optionally) volume
Output:
Expected UAS traffic density profile vs time
Suggested deconflicted UAS operational volume(s)
Deconfliction Strategy category/level
Launch/recovery geolocations

9.3 API: DSP-UFII
Input: 
Purpose of mission
Operational Volume
(mandatory) Geofence
(mandatory) Time range
(optionally) waypoints + contingency radius
(optionally) volume
Output:
List of DSPs operating in 

Open Question
What is the level 0 features?
API: DSP-UFII subscription: is this mandatory?
Deconfliction Strategy category/level. What are the categories. 
Is it possible to lay out negotiation strategies that DSPs can rely on to coordinate inflight deconfliction
Privacy issues: In-flight sharing real time flight data

