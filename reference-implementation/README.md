DEMO Registry service
=====================

## Dependencies

1. `docker`, `docker-compose`

Run `docker-compose up -d` to set up test SpiceDB, Keycloak servers and their Databases.

### Formatting Sources
```
mvn prettier:write
```

## Running

### Running Tests
```
mvn test
mvn test -Dtest="EntityTests"
```

### Registry

```
SPRING_PROFILES_ACTIVE=registry mvn compile exec:java -Dexec.mainClass="in.ispirt.pushpaka.registry.RegistryService"
```

### Flight Authorisation

```
SPRING_PROFILES_ACTIVE=flightauthorisation mvn compile exec:java -Dexec.mainClass="in.ispirt.pushpaka.flightauthorisation.FlightAuthorisationService"
```

## Overview

This server was generated by the [OpenAPI Generator](https://openapi-generator.tech) project.
By using the [OpenAPI-Spec](https://openapis.org), you can easily generate a server stub.
This is an example of building a OpenAPI-enabled server in Java using the SpringBoot framework.


The underlying library integrating OpenAPI to Spring Boot is [springdoc](https://springdoc.org).
Springdoc will generate an OpenAPI v3 specification based on the generated Controller and Model classes.
The specification is available to download using the following url:
http://localhost:8082/v3/api-docs/

Start your server as a simple java application

You can view the api documentation in swagger-ui by pointing to
http://localhost:8082/swagger-ui.html

Change default port value in application.properties



## Workflow

Login a user

```
curl -L -X POST 'http://localhost:8080/realms/pushpaka/protocol/openid-connect/token' \
-H 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'client_id=frontend' \
--data-urlencode 'grant_type=password' \
--data-urlencode 'client_secret=zEWiaDIDVPLsKVoGHc1uWIeKrv7rzzBe' \
--data-urlencode 'scope=openid' \
--data-urlencode 'username=test@test.com' \
--data-urlencode 'password=test'
```

Use JWT for API calls.

